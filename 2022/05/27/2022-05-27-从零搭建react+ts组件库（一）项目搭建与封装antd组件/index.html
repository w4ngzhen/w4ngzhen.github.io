<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"compilemind.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="为什么会有这样一篇文章？因为网上的教程&#x2F;示例只说了怎么做，没有系统详细的介绍引入这些依赖、为什么要这样配置，甚至有些文章还是错的！迫于技术洁癖，我希望更多的开发小伙伴能够真正的理解一个项目搭建各个方面的细节，做到面对对于工程出现的错误能够做到有把握。">
<meta property="og:type" content="article">
<meta property="og:title" content="从零搭建react+ts组件库（一）项目搭建与封装antd组件">
<meta property="og:url" content="http://compilemind.com/2022/05/27/2022-05-27-%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BAreact+ts%E7%BB%84%E4%BB%B6%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%B0%81%E8%A3%85antd%E7%BB%84%E4%BB%B6/index.html">
<meta property="og:site_name" content="CompileMind">
<meta property="og:description" content="为什么会有这样一篇文章？因为网上的教程&#x2F;示例只说了怎么做，没有系统详细的介绍引入这些依赖、为什么要这样配置，甚至有些文章还是错的！迫于技术洁癖，我希望更多的开发小伙伴能够真正的理解一个项目搭建各个方面的细节，做到面对对于工程出现的错误能够做到有把握。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://src-1252109805.cos.ap-chengdu.myqcloud.com/images/post/2022-05-27-webpack-ts-react/010.gif">
<meta property="og:image" content="https://src-1252109805.cos.ap-chengdu.myqcloud.com/images/post/2022-05-27-webpack-ts-react/020.jpg">
<meta property="og:image" content="https://src-1252109805.cos.ap-chengdu.myqcloud.com/images/post/2022-05-27-webpack-ts-react/030.gif">
<meta property="article:published_time" content="2022-05-26T16:00:00.000Z">
<meta property="article:modified_time" content="2022-09-12T07:06:30.586Z">
<meta property="article:author" content="w4ngzhen">
<meta property="article:tag" content="react">
<meta property="article:tag" content="ts">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://src-1252109805.cos.ap-chengdu.myqcloud.com/images/post/2022-05-27-webpack-ts-react/010.gif">

<link rel="canonical" href="http://compilemind.com/2022/05/27/2022-05-27-%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BAreact+ts%E7%BB%84%E4%BB%B6%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%B0%81%E8%A3%85antd%E7%BB%84%E4%BB%B6/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>从零搭建react+ts组件库（一）项目搭建与封装antd组件 | CompileMind</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">CompileMind</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://compilemind.com/2022/05/27/2022-05-27-%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BAreact+ts%E7%BB%84%E4%BB%B6%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%B0%81%E8%A3%85antd%E7%BB%84%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="w4ngzhen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CompileMind">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          从零搭建react+ts组件库（一）项目搭建与封装antd组件
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-27 00:00:00" itemprop="dateCreated datePublished" datetime="2022-05-27T00:00:00+08:00">2022-05-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-09-12 15:06:30" itemprop="dateModified" datetime="2022-09-12T15:06:30+08:00">2022-09-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>为什么会有这样一篇文章？因为网上的教程/示例只说了怎么做，没有系统详细的介绍引入这些依赖、为什么要这样配置，甚至有些文章还是错的！迫于技术洁癖，我希望更多的开发小伙伴能够真正的理解一个项目搭建各个方面的细节，做到面对对于工程出现的错误能够做到有把握。</p>
<a id="more"></a>
<p>最近使用阿里低开引擎的时候，想要封装一套组件库作为物料给低开引擎引入。根据低开引擎的物料封层模式，我的诉求是做一套组件库，并且将该组件库以umd方式生成。当然，从零开始开发组件库也是一个比较耗时耗力的事情，所以我想到将antd组件封装，于是催生出了本篇文章。</p>
<p><strong>在封装组件并生成umd代码过程中，踩了很多的坑，也更加系统的了解了babel。</strong></p>
<h2 id="整体需求"><a href="#整体需求" class="headerlink" title="整体需求"></a>整体需求</h2><ol>
<li><strong>react</strong>组件库，取名r-ui，能够导出<strong>r-ui.umd.js</strong>和<strong>r-ui.umd.css</strong>。</li>
<li>代码使用<strong>typescript</strong>进行开发。</li>
<li>样式使用<strong>less</strong>进行开发。</li>
<li>引入antd组件库作为底层原子组件库，并且r-ui.umd.js和r-ui.umd.css包含antd组件代码和样式代码。</li>
<li>依赖的react、react-dom模块以<strong>外部引用方式</strong>。</li>
</ol>
<h2 id="开发与打包工具选型"><a href="#开发与打包工具选型" class="headerlink" title="开发与打包工具选型"></a>开发与打包工具选型</h2><h3 id="使用webpack作为打包工具"><a href="#使用webpack作为打包工具" class="headerlink" title="使用webpack作为打包工具"></a>使用webpack作为打包工具</h3><p>老牌而又经典的打包工具，广泛的使用，丰富的插件生态以及各种易得的样例。</p>
<h3 id="使用babel来处理typescript代码"><a href="#使用babel来处理typescript代码" class="headerlink" title="使用babel来处理typescript代码"></a>使用babel来处理typescript代码</h3><blockquote>
<p>由于 TypeScript 和 Babel 团队官方合作了一年的项目：<a href="https://link.zhihu.com/?target=https%3A//babeljs.io/docs/en/babel-preset-typescript.html">TypeScript plugin for Babel</a>（<code>@babel/preset-typescript</code>），<a href="https://link.zhihu.com/?target=https%3A//www.typescriptlang.org/">TypeScript</a> 的使用变得比以往任何时候都容易。 —— 摘自《<a target="_blank" rel="noopener" href="https://iamturns.com/typescript-babel/">TypeScript With Babel: A Beautiful Marriage （TypeScript 和 Babel：美丽的结合）</a>》</p>
</blockquote>
<p>建议各位读者可以先阅读一下上面的文章（有中文翻译文章）。</p>
<h3 id="使用less-loader、css-loader等处理样式代码"><a href="#使用less-loader、css-loader等处理样式代码" class="headerlink" title="使用less-loader、css-loader等处理样式代码"></a>使用less-loader、css-loader等处理样式代码</h3><h3 id="使用MiniCssExtractPlugin分离CSS"><a href="#使用MiniCssExtractPlugin分离CSS" class="headerlink" title="使用MiniCssExtractPlugin分离CSS"></a>使用MiniCssExtractPlugin分离CSS</h3><h2 id="项目搭建思路"><a href="#项目搭建思路" class="headerlink" title="项目搭建思路"></a>项目搭建思路</h2><h3 id="整体结构"><a href="#整体结构" class="headerlink" title="整体结构"></a>整体结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- r-ui</span><br><span class="line">  |- src</span><br><span class="line">     |- components</span><br><span class="line">        |- button</span><br><span class="line">           |- index.tsx</span><br><span class="line">  |- index.tsx</span><br></pre></td></tr></table></figure>
<h3 id="方案思路"><a href="#方案思路" class="headerlink" title="方案思路"></a>方案思路</h3><p>编写webpack.config.js配置文件，添加核心loader：</p>
<ol>
<li>babel-loader。接收ts文件，交给babel-core以及相关babel插件进行处理，得到js代码。</li>
<li>less-loader。接收less样式文件，处理得到css样式代码。</li>
<li>css-loader+MiniCssExtractPlugin.loader。接收css样式代码进行处理，并分离导出组件库样式文件。</li>
</ol>
<h2 id="项目搭建实施"><a href="#项目搭建实施" class="headerlink" title="项目搭建实施"></a>项目搭建实施</h2><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p><strong>初始化r-ui项目</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir r-ui &amp;&amp; cd r-ui &amp;&amp; npm init</span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置项目基本信息（name、version......）</span></span><br></pre></td></tr></table></figure>
<p><strong>初始化git仓库，添加gitignore文件（后续所有命令非特殊情况，均相对于项目根目录）</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line"><span class="meta">#</span><span class="bash"> .gitignore文件内容请直接查看项目内文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 完成后，初始提交：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> git add . &amp;&amp; git commit -m <span class="string">&quot;init&quot;</span></span></span><br></pre></td></tr></table></figure>
<p><strong>安装webpack（包管理器使用yarn）</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D webpack webpack-cli webpack-dev-server</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装webpack-dev-server是为后续构建样例页面做准备，前期可以不安装。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/package.json b/package.json</span><br><span class="line">index e01c1b1..53dd9a3 100644</span><br><span class="line"><span class="comment">--- a/package.json</span></span><br><span class="line"><span class="comment">+++ b/package.json</span></span><br><span class="line"><span class="meta">@@ -8,5 +8,9 @@</span></span><br><span class="line">   &#125;,</span><br><span class="line">   &quot;author&quot;: &quot;&quot;,</span><br><span class="line">   &quot;license&quot;: &quot;MIT&quot;,</span><br><span class="line"><span class="deletion">-  &quot;devDependencies&quot;: &#123;&#125;</span></span><br><span class="line"><span class="addition">+  &quot;devDependencies&quot;: &#123;</span></span><br><span class="line"><span class="addition">+    &quot;webpack&quot;: &quot;^5.72.1&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;webpack-cli&quot;: &quot;^4.9.2&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;webpack-dev-server&quot;: &quot;^4.9.0&quot;</span></span><br><span class="line"><span class="addition">+  &#125;</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><strong>项目根目录添加webpack.config.js并进行初始配置</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> &#123;resolve&#125; = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 组件库的起点入口</span></span><br><span class="line">  entry: <span class="string">&#x27;./src/index.tsx&#x27;</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&quot;r-ui.umd.js&quot;</span>, <span class="comment">// 打包后的文件名</span></span><br><span class="line">    path: resolve(__dirname, <span class="string">&#x27;dist&#x27;</span>), <span class="comment">// 打包后的文件目录：根目录/dist/</span></span><br><span class="line">    library: <span class="string">&#x27;rui&#x27;</span>, <span class="comment">// 导出的UMD js会在window挂rui，即可以访问window.rui</span></span><br><span class="line">    libraryTarget: <span class="string">&#x27;umd&#x27;</span> <span class="comment">// 导出库为UMD形式</span></span><br><span class="line">  &#125;,</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    <span class="comment">// webpack 默认只处理js、jsx等js代码</span></span><br><span class="line">    extensions: [<span class="string">&#x27;.js&#x27;</span>, <span class="string">&#x27;.jsx&#x27;</span>, <span class="string">&#x27;.ts&#x27;</span>, <span class="string">&#x27;.tsx&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  externals: &#123;&#125;,</span><br><span class="line">  <span class="comment">// 模块</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 规则</span></span><br><span class="line">    rules: []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="Babel引入"><a href="#Babel引入" class="headerlink" title="Babel引入"></a>Babel引入</h3><h4 id="引入babel-loader以及相关babel库"><a href="#引入babel-loader以及相关babel库" class="headerlink" title="引入babel-loader以及相关babel库"></a>引入babel-loader以及相关babel库</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D babel-loader @babel/core @babel/preset-env @babel/preset-typescript @babel/preset-react @babel/plugin-proposal-class-properties @babel/plugin-proposal-object-rest-spread</span><br></pre></td></tr></table></figure>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/package.json b/package.json</span><br><span class="line">index 53dd9a3..33c32b6 100644</span><br><span class="line"><span class="comment">--- a/package.json</span></span><br><span class="line"><span class="comment">+++ b/package.json</span></span><br><span class="line"><span class="meta">@@ -9,6 +9,13 @@</span></span><br><span class="line">   &quot;author&quot;: &quot;&quot;,</span><br><span class="line">   &quot;license&quot;: &quot;MIT&quot;,</span><br><span class="line">   &quot;devDependencies&quot;: &#123;</span><br><span class="line"><span class="addition">+    &quot;@babel/core&quot;: &quot;^7.18.2&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;@babel/plugin-proposal-class-properties&quot;: &quot;^7.17.12&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;@babel/plugin-proposal-object-rest-spread&quot;: &quot;^7.18.0&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;@babel/preset-env&quot;: &quot;^7.18.2&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;@babel/preset-react&quot;: &quot;^7.17.12&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;@babel/preset-typescript&quot;: &quot;^7.17.12&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;babel-loader&quot;: &quot;^8.2.5&quot;,</span></span><br><span class="line">     &quot;webpack&quot;: &quot;^5.72.1&quot;,</span><br><span class="line">     &quot;webpack-cli&quot;: &quot;^4.9.2&quot;,</span><br><span class="line">     &quot;webpack-dev-server&quot;: &quot;^4.9.0&quot;</span><br><span class="line">(END)</span><br></pre></td></tr></table></figure>
<h4 id="了解Babel"><a href="#了解Babel" class="headerlink" title="了解Babel"></a>了解Babel</h4><p>如果对于babel不太熟悉，可能对这一堆的依赖感到恐惧，这里如果读者有时间，我推荐这篇深入了解babel的文章：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/43249121">一口（很长的）气了解 babel - 知乎 (zhihu.com)</a>。当然，如果这口气憋不住（哈哈），我做一个简单摘抄：</p>
<blockquote>
<p>babel 总共分为三个阶段：解析，转换，生成。</p>
<p>babel 本身不具有任何转化功能，它把转化的功能都分解到一个个 plugin 里面。因此当我们不配置任何插件时，经过 babel 的代码和输入是相同的。</p>
<p>插件总共分为两种：</p>
<ul>
<li>当我们添加 <strong>语法插件</strong> 之后，在解析这一步就使得 babel 能够解析更多的语法。(顺带一提，babel 内部使用的解析类库叫做 babylon，并非 babel 自行开发)</li>
</ul>
<p>举个简单的例子，当我们定义或者调用方法时，最后一个参数之后是不允许增加逗号的，如 <code>callFoo(param1, param2,)</code> 就是非法的。如果源码是这种写法，经过 babel 之后就会提示语法错误。</p>
<p>但最近的 JS 提案中已经允许了这种新的写法(让代码 diff 更加清晰)。为了避免 babel 报错，就需要增加语法插件 <code>babel-plugin-syntax-trailing-function-commas</code></p>
<ul>
<li>当我们添加 <strong>转译插件</strong> 之后，在转换这一步把源码转换并输出。这也是我们使用 babel 最本质的需求。</li>
</ul>
<p>比起语法插件，转译插件其实更好理解，比如箭头函数 <code>(a) =&gt; a</code> 就会转化为 <code>function (a) &#123;return a&#125;</code>。完成这个工作的插件叫做 <code>babel-plugin-transform-es2015-arrow-functions</code>。</p>
<p>同一类语法可能同时存在语法插件版本和转译插件版本。<strong>如果我们使用了转译插件，就不用再使用语法插件了。</strong></p>
</blockquote>
<p>简单来讲，使用babel就像如下流程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">源代码 &#x3D;babel&#x3D;&gt; 目标代码</span><br></pre></td></tr></table></figure>
<p>如果没有使用任何插件，源代码和目标代码就没有任何差异。当我们引入各种插件的时候，就像如下流程一样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">源代码</span><br><span class="line">|</span><br><span class="line">进入babel</span><br><span class="line">|</span><br><span class="line">babel插件1处理代码：移除某些符号</span><br><span class="line">|</span><br><span class="line">babel插件2处理代码：将形如() &#x3D;&gt; &#123;&#125;的箭头函数，转换成function xxx() &#123;&#125;</span><br><span class="line">|</span><br><span class="line">目标代码</span><br></pre></td></tr></table></figure>
<p>因为babel的插件处理的力度很细，我们代码的语法、语义内容规范有很多，如果我们要处理这些语法，可能需要配置一大堆的插件，所以babel提出，将一堆插件组合成一个preset（预置插件包），这样，我们只需要引入一个插件组合包，就能处理代码的各种语法、语义。</p>
<p>所以，回到我们上述的那些@babel开头的npm包，再回首可能不会那么迷茫：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@babel&#x2F;core</span><br><span class="line">@babel&#x2F;preset-env</span><br><span class="line">@babel&#x2F;preset-typescript</span><br><span class="line">@babel&#x2F;preset-react</span><br><span class="line">@babel&#x2F;plugin-proposal-class-properties</span><br><span class="line">@babel&#x2F;plugin-proposal-object-rest-spread</span><br></pre></td></tr></table></figure>
<p><code>@babel/core</code>毋庸置疑，babel的核心模块，实现了上述的流程运转以及代码语法、语义分析的功能。</p>
<p>以plugin开头的就是插件，这里我们引入了两个：<code>@babel/plugin-proposal-class-properties</code>（<a target="_blank" rel="noopener" href="https://babel.docschina.org/docs/en/babel-plugin-proposal-class-properties/">允许类具有属性</a>）和<code>@babel/plugin-proposal-object-rest-spread</code>（<a target="_blank" rel="noopener" href="https://babel.docschina.org/docs/en/7.0.0/babel-plugin-proposal-object-rest-spread/">对象展开</a>）。</p>
<p>以preset开头的就是预置组件包合集，其中<code>@babel/preset-env</code>表示使用了可以根据实际的浏览器运行环境，会选择相关的转义插件包：</p>
<blockquote>
<p>env 的核心目的是通过配置得知目标环境的特点，然后只做必要的转换。</p>
<p>如果不写任何配置项，env 等价于 latest，也等价于 es2015 + es2016 + es2017 三个相加(不包含 stage-x 中的插件)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&#123;</span><br><span class="line"> &quot;presets&quot;: [</span><br><span class="line">   [&quot;env&quot;, &#123;</span><br><span class="line">     &quot;targets&quot;: &#123;</span><br><span class="line">       &quot;browsers&quot;: [&quot;last 2 versions&quot;, &quot;safari &gt;&#x3D; 7&quot;]</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;]</span><br><span class="line"> ]</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>
<p>如上配置将考虑所有浏览器的最新2个版本(safari大于等于7.0的版本)的特性，将必要的代码进行转换。而这些版本已有的功能就不进行转化了。</p>
<p>—— 摘自《<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/43249121">一口（很长的）气了解 babel - 知乎 (zhihu.com)</a>》</p>
</blockquote>
<p><code>@babel/preset-typescript</code>会处理所有ts的代码的语法和语义规则，并转换为js代码；<code>@babel/preset-react</code></p>
<p>故名思义，<strong>可以帮助处理使用React相关特性</strong>，例如JSX标签语法等。</p>
<h4 id="webpack的基于babel-loader的处理流程"><a href="#webpack的基于babel-loader的处理流程" class="headerlink" title="webpack的基于babel-loader的处理流程"></a>webpack的基于babel-loader的处理流程</h4><p>讲了这么多，我们的打包工具webpack如何使用babel相关组件处理代码的呢？还记得我们安装过<strong>babel-loader</strong>吗？</p>
<p>实际上，我们通过配置webpack.config.js，使用<strong>babel-loader</strong>建立起webpack处理代码与babel处理代码的连接：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/webpack.config.js b/webpack.config.js</span><br><span class="line">index 8bfbb63..6767fd8 100644</span><br><span class="line"><span class="comment">--- a/webpack.config.js</span></span><br><span class="line"><span class="comment">+++ b/webpack.config.js</span></span><br><span class="line">@@ -17,6 +17,11 @@ module.exports = &#123;</span><br><span class="line">   // 模块</span><br><span class="line">   module: &#123;</span><br><span class="line">     // 规则</span><br><span class="line"><span class="deletion">-    rules: []</span></span><br><span class="line"><span class="addition">+    rules: [</span></span><br><span class="line"><span class="addition">+      &#123;</span></span><br><span class="line"><span class="addition">+        test: /\.tsx?$/,</span></span><br><span class="line"><span class="addition">+        use: &#x27;babel-loader&#x27;,</span></span><br><span class="line"><span class="addition">+        exclude: /node_modules/</span></span><br><span class="line"><span class="addition">+      &#125;</span></span><br><span class="line"><span class="addition">+    ]</span></span><br><span class="line">   &#125;</span><br><span class="line"> &#125;;</span><br><span class="line">(END)</span><br></pre></td></tr></table></figure>
<p>这一步的配置，就是让webpack遇到ts或tsx的时候，将这些代码交给babel-loader，babel-loader作为桥接把代码交给内部引用的@babel/core相关API进行处理，当然为了防止babel-loader去解析依赖库node_modules的内容，需要配置exclude。</p>
<p>那么，@babel/core如何知道要使用我们安装的各种plugin插件和preset预置插件包的呢？通过<code>.babelrc文件</code>（注：实际上还有其他配置方式，但个人倾向于.babelrc）。这里，我们在项目根目录创建.babelrc文件，并添加一下内容：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;presets&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;@babel/preset-env&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@babel/preset-typescript&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@babel/preset-react&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;@babel/plugin-proposal-class-properties&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@babel/plugin-proposal-object-rest-spread&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的配置不难理解，plugins字段存放要使用的插件，presets字段存放预置插件包名称，具体的配置可以查阅官方文档。</p>
<p><strong>总结一下，配置babel可以按照如下思路进行：</strong></p>
<ol>
<li>xxx.ts(x)代码交给webpack打包；</li>
<li>webpack遇到ts(x)结尾的代码文件，根据webpack.config.js配置，交给babel-loader；</li>
<li>babel-loader交给@babel/core；</li>
<li>@babel/core根据.babelrc配置交给相关的插件处理代码，转为js代码；</li>
<li>webpack进行后续的打包操作。</li>
</ol>
<h3 id="引入React相关库（externals方式）"><a href="#引入React相关库（externals方式）" class="headerlink" title="引入React相关库（externals方式）"></a>引入React相关库（externals方式）</h3><p>还记得我们的需求吗？</p>
<blockquote>
<p>依赖的react、react-dom模块以<strong>外部引用方式</strong>。</p>
</blockquote>
<p>什么是外部引用方式？简单来讲，我希望react、react-dom等组件库的包，不会被打入到组件库中，而是在html中引入（<a target="_blank" rel="noopener" href="https://17.reactjs.org/docs/add-react-to-a-website.html#step-2-add-the-script-tags">Add React to a Website – React (reactjs.org)</a>）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">&lt;!-- ... other HTML ... --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Load React. --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- <span class="doctag">Note:</span> when deploying, replace &quot;development.js&quot; with &quot;production.min.js&quot;. --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@17/umd/react.development.js&quot;</span> <span class="attr">crossorigin</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react-dom@17/umd/react-dom.development.js&quot;</span> <span class="attr">crossorigin</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 组件库JS --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;r-ui.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>要实现这样的效果，第一步是配置webapck.config.js：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/webpack.config.js b/webpack.config.js</span><br><span class="line">index 6767fd8..54fc0e5 100644</span><br><span class="line"><span class="comment">--- a/webpack.config.js</span></span><br><span class="line"><span class="comment">+++ b/webpack.config.js</span></span><br><span class="line">@@ -13,7 +13,13 @@ module.exports = &#123;</span><br><span class="line">     // webpack 默认只处理js、jsx等js代码</span><br><span class="line">     extensions: [&#x27;.js&#x27;, &#x27;.jsx&#x27;, &#x27;.ts&#x27;, &#x27;.tsx&#x27;]</span><br><span class="line">   &#125;,</span><br><span class="line"><span class="deletion">-  externals: &#123;&#125;,</span></span><br><span class="line"><span class="addition">+  externals: &#123;</span></span><br><span class="line"><span class="addition">+    // 打包过程遇到以下依赖导入，不会打包对应库代码，而是调用window上的React和ReactDOM</span></span><br><span class="line"><span class="addition">+    // import React from &#x27;react&#x27;</span></span><br><span class="line"><span class="addition">+    // import ReactDOM from &#x27;react-dom&#x27;</span></span><br><span class="line"><span class="addition">+    &#x27;react&#x27;: &#x27;React&#x27;,</span></span><br><span class="line"><span class="addition">+    &#x27;react-dom&#x27;: &#x27;ReactDOM&#x27;</span></span><br><span class="line"><span class="addition">+  &#125;,</span></span><br><span class="line">   // 模块</span><br><span class="line">   module: &#123;</span><br><span class="line">     // 规则</span><br><span class="line">(END)</span><br></pre></td></tr></table></figure>
<p>第二部，在引入react相关库的时候，可以不用引入到dependencies运行时依赖，而只需要引入对应的类型定义到devDependencies开发依赖中：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D @types/react@17.0.39 @types/react-dom@17.0.17</span><br></pre></td></tr></table></figure>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/package.json b/package.json</span><br><span class="line">index 33c32b6..bd17763 100644</span><br><span class="line"><span class="comment">--- a/package.json</span></span><br><span class="line"><span class="comment">+++ b/package.json</span></span><br><span class="line"><span class="meta">@@ -15,6 +15,8 @@</span></span><br><span class="line">     &quot;@babel/preset-env&quot;: &quot;^7.18.2&quot;,</span><br><span class="line">     &quot;@babel/preset-react&quot;: &quot;^7.17.12&quot;,</span><br><span class="line">     &quot;@babel/preset-typescript&quot;: &quot;^7.17.12&quot;,</span><br><span class="line"><span class="addition">+    &quot;@types/react&quot;: &quot;17.0.39&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;@types/react-dom&quot;: &quot;17.0.17&quot;,</span></span><br><span class="line">     &quot;babel-loader&quot;: &quot;^8.2.5&quot;,</span><br><span class="line">     &quot;webpack&quot;: &quot;^5.72.1&quot;,</span><br><span class="line">     &quot;webpack-cli&quot;: &quot;^4.9.2&quot;,</span><br></pre></td></tr></table></figure>
<p>至此，我们已经完成了处理<strong>基于TypeScript</strong>的<strong>React项目</strong>的webpack配置，此时我们的项目结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- r-ui</span><br><span class="line">  |- .babelrc</span><br><span class="line">  |- package.json</span><br><span class="line">  |- webpack.config.js</span><br></pre></td></tr></table></figure>
<h3 id="阶段演示1：基于TypeScript的React组件项目的webpack配置可行性"><a href="#阶段演示1：基于TypeScript的React组件项目的webpack配置可行性" class="headerlink" title="阶段演示1：基于TypeScript的React组件项目的webpack配置可行性"></a>阶段演示1：基于TypeScript的React组件项目的webpack配置可行性</h3><h4 id="编写组件代码"><a href="#编写组件代码" class="headerlink" title="编写组件代码"></a>编写组件代码</h4><p>新增src目录，在src目录下添加index.tsx（用于将所有的组件导出）</p>
<p>src目录下添加components/button目录，并创建index.tsx文件。具体结构与目录如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- r-ui</span><br><span class="line">  |- src&#x2F;components&#x2F;button&#x2F;index.tsx</span><br><span class="line">  |- src&#x2F;index.tsx</span><br><span class="line">  |- ... ...</span><br></pre></td></tr></table></figure>
<p><strong>src/components/button/index.tsx</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import * as React from &#39;react&#39;;</span><br><span class="line"></span><br><span class="line">interface ButtonProps &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Button: React.FC&lt;ButtonProps&gt; &#x3D; (props) &#x3D;&gt; &#123;</span><br><span class="line">    const &#123;children, ...rest&#125; &#x3D; props;</span><br><span class="line">    return &lt;button &#123;...rest&#125; &gt;&#123;children&#125;&lt;&#x2F;button&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Button;</span><br></pre></td></tr></table></figure>
<p><strong>src/index.tsx</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export &#123;default as Button&#125; from &#39;.&#x2F;components&#x2F;button&#39;;</span><br></pre></td></tr></table></figure>
<h4 id="修改package-json"><a href="#修改package-json" class="headerlink" title="修改package.json"></a>修改package.json</h4><p>添加webpack处理脚本</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/package.json b/package.json</span><br><span class="line">index bd17763..01565ad 100644</span><br><span class="line"><span class="comment">--- a/package.json</span></span><br><span class="line"><span class="comment">+++ b/package.json</span></span><br><span class="line"><span class="meta">@@ -4,6 +4,7 @@</span></span><br><span class="line">   &quot;description&quot;: &quot;&quot;,</span><br><span class="line">   &quot;main&quot;: &quot;index.js&quot;,</span><br><span class="line">   &quot;scripts&quot;: &#123;</span><br><span class="line"><span class="addition">+    &quot;build&quot;: &quot;webpack --config webpack.config.js&quot;,</span></span><br><span class="line">     &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">   &#125;,</span><br><span class="line">   &quot;author&quot;: &quot;&quot;,</span><br><span class="line">(END)</span><br></pre></td></tr></table></figure>
<h4 id="编译打包组件库"><a href="#编译打包组件库" class="headerlink" title="编译打包组件库"></a>编译打包组件库</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn run build</span><br></pre></td></tr></table></figure>
<p>打包完成后，在<strong>项目根目录/dist目录</strong>下，会生成一个r-ui.umd.js文件。</p>
<h4 id="效果演示"><a href="#效果演示" class="headerlink" title="效果演示"></a>效果演示</h4><p>想要查看效果，可以在dist目录下添加如下的html：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>r-ui example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@17/umd/react.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react-dom@17/umd/react-dom.development.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 注意r-ui.umd.js的路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;r-ui.umd.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;example&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> onClick = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    alert(<span class="string">&#x27;hello&#x27;</span>);</span></span><br><span class="line">  &#125;;</span><br><span class="line"><span class="javascript">  <span class="comment">// window上存在rui，是因为我们将组件包导出为了umd包，取名为rui</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 使用React原生方法创建Button的react组件实例</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 等价于：</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">  // <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onClick</span>=<span class="string">&#123;onClick&#125;</span>&gt;</span>hello, world<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> button = React.createElement(rui.Button, &#123;onClick&#125;, <span class="string">&#x27;hello, world&#x27;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 调用ReactDOM方法，将button组件实例挂载到example DOM节点上</span></span></span><br><span class="line"><span class="javascript">  ReactDOM.render(button, <span class="built_in">document</span>.getElementById(<span class="string">&#x27;example&#x27;</span>));</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- r-ui</span><br><span class="line">  |- dist</span><br><span class="line">     |- index.html</span><br><span class="line">     |- r-ui.umd.js</span><br><span class="line">  |- ... ...</span><br></pre></td></tr></table></figure>
<p>此时，可以直接使用浏览器打开index.html查看效果：</p>
<p><img src="https://src-1252109805.cos.ap-chengdu.myqcloud.com/images/post/2022-05-27-webpack-ts-react/010.gif" alt="010"></p>
<h3 id="处理样式（less编译与css导出）"><a href="#处理样式（less编译与css导出）" class="headerlink" title="处理样式（less编译与css导出）"></a>处理样式（less编译与css导出）</h3><h4 id="依赖引入"><a href="#依赖引入" class="headerlink" title="依赖引入"></a>依赖引入</h4><p>根据上述内容，我们已经搭建了基础的项目结构，但是目前来说我们还需要处理我们的less样式，并且能够支持导出r-ui.umd.css样式文件。基于此考虑，我们需要引入：</p>
<ol>
<li>less-loader。处理less样式代码，转为css；</li>
<li>less。由于less-loader内部是调用了less模块进行less代码编译，故还需要引入less（模式和babel-loader内部使用@babel/core一样）；</li>
<li>css-loader。处理css样式代码，进行适当加工；</li>
<li>mini-css-extract-plugin。MiniCssExtractPlugin的loader用于进一步处理css，并且该插件用于导出独立样式文件。</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D less-loader less css-loader mini-css-extract-plugin</span><br></pre></td></tr></table></figure>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/package.json b/package.json</span><br><span class="line">index 01565ad..3070d07 100644</span><br><span class="line"><span class="comment">--- a/package.json</span></span><br><span class="line"><span class="comment">+++ b/package.json</span></span><br><span class="line"><span class="meta">@@ -19,6 +19,10 @@</span></span><br><span class="line">     &quot;@types/react&quot;: &quot;17.0.39&quot;,</span><br><span class="line">     &quot;@types/react-dom&quot;: &quot;17.0.17&quot;,</span><br><span class="line">     &quot;babel-loader&quot;: &quot;^8.2.5&quot;,</span><br><span class="line"><span class="addition">+    &quot;css-loader&quot;: &quot;^6.7.1&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;less&quot;: &quot;^4.1.2&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;less-loader&quot;: &quot;^11.0.0&quot;,</span></span><br><span class="line"><span class="addition">+    &quot;mini-css-extract-plugin&quot;: &quot;^2.6.0&quot;,</span></span><br><span class="line">     &quot;webpack&quot;: &quot;^5.72.1&quot;,</span><br><span class="line">     &quot;webpack-cli&quot;: &quot;^4.9.2&quot;,</span><br><span class="line">     &quot;webpack-dev-server&quot;: &quot;^4.9.0&quot;</span><br></pre></td></tr></table></figure>
<h4 id="配置webpack"><a href="#配置webpack" class="headerlink" title="配置webpack"></a>配置webpack</h4><p>根据上述依赖，我们可以知道需要less-loader、css-loader以及MiniCssExtractPlugin的内置loader来处理我们的样式代码。但是配置到webpack需要注意： webpack中的顺序是<strong>【从后向前】</strong>链式调用的，所以注意下面配置的代码中use数组的顺序：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/webpack.config.js b/webpack.config.js</span><br><span class="line">index 54fc0e5..9db43b8 100644</span><br><span class="line"><span class="comment">--- a/webpack.config.js</span></span><br><span class="line"><span class="comment">+++ b/webpack.config.js</span></span><br><span class="line"><span class="meta">@@ -1,5 +1,6 @@</span></span><br><span class="line"> // webpack.config.js</span><br><span class="line"> const &#123;resolve&#125; = require(&quot;path&quot;);</span><br><span class="line"><span class="addition">+const MiniCssExtractPlugin = require(&#x27;mini-css-extract-plugin&#x27;);</span></span><br><span class="line"> module.exports = &#123;</span><br><span class="line">   // 组件库的起点入口</span><br><span class="line">   entry: &#x27;./src/index.tsx&#x27;,</span><br><span class="line">@@ -27,7 +28,28 @@ module.exports = &#123;</span><br><span class="line">       &#123;</span><br><span class="line">         test: /\.tsx?$/,</span><br><span class="line">         use: &#x27;babel-loader&#x27;,</span><br><span class="line">         exclude: /node_modules/</span><br><span class="line"><span class="addition">+      &#125;,</span></span><br><span class="line"><span class="addition">+      &#123;</span></span><br><span class="line"><span class="addition">+        test: /\.less$/,</span></span><br><span class="line"><span class="addition">+        use: [</span></span><br><span class="line"><span class="addition">+          // webpack中的顺序是【从后向前】链式调用的</span></span><br><span class="line"><span class="addition">+          // 所以对于less先交给less-loader处理，转为css</span></span><br><span class="line"><span class="addition">+          // 再交给css-loader</span></span><br><span class="line"><span class="addition">+          // 最后导出css（MiniCssExtractPlugin.loader）</span></span><br><span class="line"><span class="addition">+          // 所以注意loader的配置顺序</span></span><br><span class="line"><span class="addition">+          &#123;</span></span><br><span class="line"><span class="addition">+            loader: MiniCssExtractPlugin.loader,</span></span><br><span class="line"><span class="addition">+          &#125;,</span></span><br><span class="line"><span class="addition">+          &#x27;css-loader&#x27;,</span></span><br><span class="line"><span class="addition">+          &#x27;less-loader&#x27;</span></span><br><span class="line"><span class="addition">+        ]</span></span><br><span class="line">       &#125;</span><br><span class="line">     ]</span><br><span class="line"><span class="deletion">-  &#125;</span></span><br><span class="line"><span class="addition">+  &#125;,</span></span><br><span class="line"><span class="addition">+  plugins: [</span></span><br><span class="line"><span class="addition">+    // 插件用于最终的导出独立的css的工作</span></span><br><span class="line"><span class="addition">+    new MiniCssExtractPlugin(&#123;</span></span><br><span class="line"><span class="addition">+      filename: &#x27;r-ui.umd.css&#x27;</span></span><br><span class="line"><span class="addition">+    &#125;),</span></span><br><span class="line"><span class="addition">+  ]</span></span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure>
<h3 id="阶段演示2：less样式处理配置可行性"><a href="#阶段演示2：less样式处理配置可行性" class="headerlink" title="阶段演示2：less样式处理配置可行性"></a>阶段演示2：less样式处理配置可行性</h3><h4 id="编写样式代码"><a href="#编写样式代码" class="headerlink" title="编写样式代码"></a>编写样式代码</h4><p>新增<strong>src/components/button/index.less</strong></p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@color:</span> <span class="number">#006fde</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.my-button</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">@color</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改<strong>src/components/button/index.tsx</strong></p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> import * as React from &#x27;react&#x27;;</span><br><span class="line"><span class="addition">+// 引入less样式</span></span><br><span class="line"><span class="addition">+import &#x27;./index.less&#x27;;</span></span><br><span class="line"> </span><br><span class="line"> interface ButtonProps &#123;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> const Button: React.FC&lt;ButtonProps&gt; = (props) =&gt; &#123;</span><br><span class="line">     const &#123;children, ...rest&#125; = props;</span><br><span class="line"><span class="deletion">-    return &lt;button &#123;...rest&#125; &gt;&#123;children&#125;&lt;/button&gt;</span></span><br><span class="line"><span class="addition">+    // 使用my-button样式</span></span><br><span class="line"><span class="addition">+    return &lt;button &#123;...rest&#125; className=&#x27;my-button&#x27;&gt;&#123;children&#125;&lt;/button&gt;</span></span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> export default Button;</span><br></pre></td></tr></table></figure>
<h4 id="编译组件库"><a href="#编译组件库" class="headerlink" title="编译组件库"></a>编译组件库</h4><p>再次打包组件库以后，dist目录下会额外生成文件：r-ui.umd.css。所以，我们需要在index.html中添加样式文件的引入：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> &lt;head&gt;</span><br><span class="line">     &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">     &lt;title&gt;r-ui example&lt;/title&gt;</span><br><span class="line">     &lt;script src=&quot;https://unpkg.com/react@17/umd/react.development.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">     &lt;script src=&quot;https://unpkg.com/react-dom@17/umd/react-dom.development.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">     &lt;script src=&quot;r-ui.umd.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"><span class="addition">+    &lt;link href=&quot;r-ui.umd.css&quot; rel=&quot;stylesheet&quot;/&gt;</span></span><br><span class="line"> &lt;/head&gt;</span><br></pre></td></tr></table></figure>
<h4 id="效果演示-1"><a href="#效果演示-1" class="headerlink" title="效果演示"></a>效果演示</h4><p>刷新页面后，可以看到按钮的文字颜色已经生效</p>
<p><img src="https://src-1252109805.cos.ap-chengdu.myqcloud.com/images/post/2022-05-27-webpack-ts-react/020.jpg" alt="020"></p>
<h3 id="引入AntDesign"><a href="#引入AntDesign" class="headerlink" title="引入AntDesign"></a>引入AntDesign</h3><p>根据我们的需求，我们希望将antd组件代码引用到我们组件内部进行封装，所以需要以dependencies方式引入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add antd</span><br></pre></td></tr></table></figure>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/package.json b/package.json</span><br><span class="line">index 3070d07..09ca792 100644</span><br><span class="line"><span class="comment">--- a/package.json</span></span><br><span class="line"><span class="comment">+++ b/package.json</span></span><br><span class="line"><span class="meta">@@ -26,5 +26,8 @@</span></span><br><span class="line">     &quot;webpack&quot;: &quot;^5.72.1&quot;,</span><br><span class="line">     &quot;webpack-cli&quot;: &quot;^4.9.2&quot;,</span><br><span class="line">     &quot;webpack-dev-server&quot;: &quot;^4.9.0&quot;</span><br><span class="line"><span class="addition">+  &#125;,</span></span><br><span class="line"><span class="addition">+  &quot;dependencies&quot;: &#123;</span></span><br><span class="line"><span class="addition">+    &quot;antd&quot;: &quot;^4.20.6&quot;</span></span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="引用antd的button样式"><a href="#引用antd的button样式" class="headerlink" title="引用antd的button样式"></a>引用antd的button样式</h4><p><strong>src/components/button/index.less</strong></p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-@color: #006fde;</span></span><br><span class="line"><span class="deletion">-</span></span><br><span class="line"><span class="deletion">-.my-button &#123;</span></span><br><span class="line"><span class="deletion">-  color: @color;</span></span><br><span class="line"><span class="deletion">-&#125;</span></span><br><span class="line"><span class="addition">+@import &quot;~antd/lib/button/style/index.css&quot;;</span></span><br></pre></td></tr></table></figure>
<h4 id="引用antd的button组件"><a href="#引用antd的button组件" class="headerlink" title="引用antd的button组件"></a>引用antd的button组件</h4><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> import * as React from &#x27;react&#x27;;</span><br><span class="line"><span class="addition">+// 使用antd的Button和ButtonProps</span></span><br><span class="line"><span class="addition">+// 为了不和我们的Button冲突，需要改导出名</span></span><br><span class="line"><span class="addition">+import &#123;Button as AntdButton, ButtonProps as AntdButtonProps&#125; from &#x27;antd&#x27;;</span></span><br><span class="line"> // 引入less样式</span><br><span class="line"> import &#x27;./index.less&#x27;;</span><br><span class="line"> </span><br><span class="line"><span class="deletion">-interface ButtonProps &#123;</span></span><br><span class="line"><span class="addition">+interface ButtonProps extends AntdButtonProps &#123;</span></span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> const Button: React.FC&lt;ButtonProps&gt; = (props) =&gt; &#123;</span><br><span class="line">     const &#123;children, ...rest&#125; = props;</span><br><span class="line"><span class="deletion">-    // 使用my-button样式</span></span><br><span class="line"><span class="deletion">-    return &lt;button &#123;...rest&#125; className=&#x27;my-button&#x27;&gt;&#123;children&#125;&lt;/button&gt;</span></span><br><span class="line"><span class="addition">+    // 使用AntdButton</span></span><br><span class="line"><span class="addition">+    return &lt;AntdButton &#123;...rest&#125;&gt;&#123;children&#125;&lt;/AntdButton&gt;</span></span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> export default Button;</span><br></pre></td></tr></table></figure>
<h3 id="阶段演示3：antd组件引入可行性"><a href="#阶段演示3：antd组件引入可行性" class="headerlink" title="阶段演示3：antd组件引入可行性"></a>阶段演示3：antd组件引入可行性</h3><p>通过上述的代码修改以后，我们直接进行编译，然后检查效果即可：</p>
<p><img src="https://src-1252109805.cos.ap-chengdu.myqcloud.com/images/post/2022-05-27-webpack-ts-react/030.gif" alt="030"></p>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>实际上，代码开发过程中，还有很多可以辅助开发的模块、流程，例如eslint检查，热更新等。但是那些内容不在本文的讨论范围。后续会出相关的文章再进一步进行介绍。</p>
<p>本文所搭建的整个项目，我都按照文章一步一步进行了git提交，开发小伙伴可以边阅读文章边对照git提交一步一步来看。</p>
<p>github地址：<a target="_blank" rel="noopener" href="https://github.com/w4ngzhen/r-ui">w4ngzhen/r-ui (github.com)</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/react/" rel="tag"># react</a>
              <a href="/tags/ts/" rel="tag"># ts</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/04/22/2022-04-22-%E9%98%BF%E9%87%8C%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%BC%95%E6%93%8E%E7%89%A9%E6%96%99%E5%BC%80%E5%8F%91windows%E4%B8%8B%E9%80%82%E9%85%8D/" rel="prev" title="阿里低代码引擎物料开发windows下路径问题临时处理">
      <i class="fa fa-chevron-left"></i> 阿里低代码引擎物料开发windows下路径问题临时处理
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/07/22/2022-07-22-%E3%80%8A%E4%B8%96%E5%98%89%E6%96%B0%E4%BA%BA%E5%9F%B9%E8%AE%AD%E6%95%99%E6%9D%90%E2%80%94%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91%E3%80%8B2DGraphics1%E9%A1%B9%E7%9B%AEcmake%E6%9E%84%E5%BB%BA/" rel="next" title="《世嘉新人培训教材—游戏开发》2DGraphics1项目cmake构建">
      《世嘉新人培训教材—游戏开发》2DGraphics1项目cmake构建 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B4%E4%BD%93%E9%9C%80%E6%B1%82"><span class="nav-number">1.</span> <span class="nav-text">整体需求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E4%B8%8E%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%E9%80%89%E5%9E%8B"><span class="nav-number">2.</span> <span class="nav-text">开发与打包工具选型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8webpack%E4%BD%9C%E4%B8%BA%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7"><span class="nav-number">2.1.</span> <span class="nav-text">使用webpack作为打包工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8babel%E6%9D%A5%E5%A4%84%E7%90%86typescript%E4%BB%A3%E7%A0%81"><span class="nav-number">2.2.</span> <span class="nav-text">使用babel来处理typescript代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8less-loader%E3%80%81css-loader%E7%AD%89%E5%A4%84%E7%90%86%E6%A0%B7%E5%BC%8F%E4%BB%A3%E7%A0%81"><span class="nav-number">2.3.</span> <span class="nav-text">使用less-loader、css-loader等处理样式代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8MiniCssExtractPlugin%E5%88%86%E7%A6%BBCSS"><span class="nav-number">2.4.</span> <span class="nav-text">使用MiniCssExtractPlugin分离CSS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E6%80%9D%E8%B7%AF"><span class="nav-number">3.</span> <span class="nav-text">项目搭建思路</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84"><span class="nav-number">3.1.</span> <span class="nav-text">整体结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%A1%88%E6%80%9D%E8%B7%AF"><span class="nav-number">3.2.</span> <span class="nav-text">方案思路</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E5%AE%9E%E6%96%BD"><span class="nav-number">4.</span> <span class="nav-text">项目搭建实施</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">4.1.</span> <span class="nav-text">初始化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Babel%E5%BC%95%E5%85%A5"><span class="nav-number">4.2.</span> <span class="nav-text">Babel引入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E5%85%A5babel-loader%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3babel%E5%BA%93"><span class="nav-number">4.2.1.</span> <span class="nav-text">引入babel-loader以及相关babel库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%86%E8%A7%A3Babel"><span class="nav-number">4.2.2.</span> <span class="nav-text">了解Babel</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack%E7%9A%84%E5%9F%BA%E4%BA%8Ebabel-loader%E7%9A%84%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B"><span class="nav-number">4.2.3.</span> <span class="nav-text">webpack的基于babel-loader的处理流程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E5%85%A5React%E7%9B%B8%E5%85%B3%E5%BA%93%EF%BC%88externals%E6%96%B9%E5%BC%8F%EF%BC%89"><span class="nav-number">4.3.</span> <span class="nav-text">引入React相关库（externals方式）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5%E6%BC%94%E7%A4%BA1%EF%BC%9A%E5%9F%BA%E4%BA%8ETypeScript%E7%9A%84React%E7%BB%84%E4%BB%B6%E9%A1%B9%E7%9B%AE%E7%9A%84webpack%E9%85%8D%E7%BD%AE%E5%8F%AF%E8%A1%8C%E6%80%A7"><span class="nav-number">4.4.</span> <span class="nav-text">阶段演示1：基于TypeScript的React组件项目的webpack配置可行性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E7%BB%84%E4%BB%B6%E4%BB%A3%E7%A0%81"><span class="nav-number">4.4.1.</span> <span class="nav-text">编写组件代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9package-json"><span class="nav-number">4.4.2.</span> <span class="nav-text">修改package.json</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E8%AF%91%E6%89%93%E5%8C%85%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="nav-number">4.4.3.</span> <span class="nav-text">编译打包组件库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%88%E6%9E%9C%E6%BC%94%E7%A4%BA"><span class="nav-number">4.4.4.</span> <span class="nav-text">效果演示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%84%E7%90%86%E6%A0%B7%E5%BC%8F%EF%BC%88less%E7%BC%96%E8%AF%91%E4%B8%8Ecss%E5%AF%BC%E5%87%BA%EF%BC%89"><span class="nav-number">4.5.</span> <span class="nav-text">处理样式（less编译与css导出）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96%E5%BC%95%E5%85%A5"><span class="nav-number">4.5.1.</span> <span class="nav-text">依赖引入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEwebpack"><span class="nav-number">4.5.2.</span> <span class="nav-text">配置webpack</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5%E6%BC%94%E7%A4%BA2%EF%BC%9Aless%E6%A0%B7%E5%BC%8F%E5%A4%84%E7%90%86%E9%85%8D%E7%BD%AE%E5%8F%AF%E8%A1%8C%E6%80%A7"><span class="nav-number">4.6.</span> <span class="nav-text">阶段演示2：less样式处理配置可行性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E6%A0%B7%E5%BC%8F%E4%BB%A3%E7%A0%81"><span class="nav-number">4.6.1.</span> <span class="nav-text">编写样式代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E8%AF%91%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="nav-number">4.6.2.</span> <span class="nav-text">编译组件库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%88%E6%9E%9C%E6%BC%94%E7%A4%BA-1"><span class="nav-number">4.6.3.</span> <span class="nav-text">效果演示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E5%85%A5AntDesign"><span class="nav-number">4.7.</span> <span class="nav-text">引入AntDesign</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E7%94%A8antd%E7%9A%84button%E6%A0%B7%E5%BC%8F"><span class="nav-number">4.7.1.</span> <span class="nav-text">引用antd的button样式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%95%E7%94%A8antd%E7%9A%84button%E7%BB%84%E4%BB%B6"><span class="nav-number">4.7.2.</span> <span class="nav-text">引用antd的button组件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5%E6%BC%94%E7%A4%BA3%EF%BC%9Aantd%E7%BB%84%E4%BB%B6%E5%BC%95%E5%85%A5%E5%8F%AF%E8%A1%8C%E6%80%A7"><span class="nav-number">4.8.</span> <span class="nav-text">阶段演示3：antd组件引入可行性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E"><span class="nav-number">5.</span> <span class="nav-text">写在最后</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="w4ngzhen"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">w4ngzhen</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">75</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/w4ngzhen" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;w4ngzhen" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">w4ngzhen</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
